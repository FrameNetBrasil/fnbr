<div id="reportLULayout" style="width:100%;height:100%;">
    <div id="reportLUCenterPane" region="center" title="Lexical Entry" style="height: 60%">

<div class="reportLU">
    <div class="luName">
        {{$data->lu->name|noescape}}
    </div>
    <div class="frameName">
        Frame: {{$data->lu->frameName|noescape}}
    </div>
    <div class="divPanel">
        <div id="panelDefinition" class="easyui-panel" title="{{_'repDefinition'}}" collapsible="false" data-options="fit:true"  style="width:100%;">
            <div class="text">
                {{$data->lu->senseDescription|noescape}}
            </div>
        </div>
    </div>
    <div class="divPanel">
        <div id="panelRealizations" class="easyui-panel" title="{{_'repSyntaticRealizations'}}" collapsible="true" data-options="fit:true"  style="width:100%;">
            <div class="text">The Frame Elements for this word sense are (with realizations):</div>
            <table class="tableRealizations">
                <tr>
                    <th>Frame Element</th>
                    <th>Number Annotated</th>
                    <th>Realization(s)</th>
                </tr>
                <tbody>
                {{foreach $data->realizations as $feEntry => $gfptas}}
                <tr>
                    <td>
                        <span class="{{$data->feIcon[$data->fes[$feEntry]['type']]}}">&nbsp;&nbsp;</span></span><span class="fe_{{$data->fes[$feEntry]['entry']}}">{{$data->fes[$feEntry]['name']}}</span>
                    </td>
                    <td>
                        <a href="#" onclick="javascript:addFESentences('{{$feEntry|noescape}}')">
                        {{count($data->fes[$feEntry]['as'])}}
                        </a>
                    </td>
                    <td>
                        {{foreach $gfptas as $gf => $ptas}}
                            {{foreach $ptas as $pt => $idRealization}}
                                {{$gf}}.{{$pt}}&nbsp;&nbsp;
                                <a href="#" onclick="javascript:addASSentences(realizationAS['{{$idRealization[0]|noescape}}'])">
                                    ({{count($data->realizationAS[$idRealization[0]])}})
                                </a>
                                <br/>
                            {{/foreach}}
                        {{/foreach}}
                    </td>
                </tr>
                {{/foreach}}
                </tbody>
            </table>
        </div>
    </div>

    <div class="divPanel">
        <div id="panelVP" class="easyui-panel" title="{{_'repVP'}}" collapsible="true" data-options="fit:true"  style="width:100%;">
            <div class="text">These frame elements occur in the following syntactic patterns:</div>
            <table class="tableVP">
                <tr>
                    <th>Number Annotated</th>
                    <th colspan="{{$data->maxCountFE}}">Patterns</th>
                </tr>
                <tbody>
                {{foreach $data->vp as $idVPFE => $vp}}
                    {{foreach $data->patterns[$idVPFE] as $idVP => $scfegfptas}}
                        {{if $iterator->first}}
                        <tr class="pattern">
                            <td>{{$data->vpfe[$idVPFE]['count']}}</td>
                            {{foreach $scfegfptas as $sc => $fegfptas}}
                                {{foreach $fegfptas as $feEntry => $gfptas}}
                                    {{foreach $gfptas as $gf => $ptas}}
                                        {{foreach $ptas as $pt => $as}}
                            <td><span class="{{$data->feIcon[$data->fes[$feEntry]['type']]}}">&nbsp;&nbsp;</span></span><span class="fe_{{$data->fes[$feEntry]['entry']}}">{{$data->fes[$feEntry]['name']}}</span></td>
                                        {{/foreach}}
                                    {{/foreach}}
                                {{/foreach}}
                            {{/foreach}}
                            {{for $i = count($scfegfptas); $i < $data->maxCountFE; $i++}}
                                <td></td>
                            {{/for}}
                        </tr>
                        {{/if}}
                        <tr>
                            <td>{{count($data->vp[$idVPFE][$idVP])}}</td>
                            {{foreach $scfegfptas as $sc => $fegfptas}}
                                {{foreach $fegfptas as $fe => $gfptas}}
                                    {{foreach $gfptas as $gf => $ptas}}
                                        {{foreach $ptas as $pt => $as}}
                                            <td>{{$gf}}<br/>{{$pt}}</td>
                                        {{/foreach}}
                                    {{/foreach}}
                                {{/foreach}}
                            {{/foreach}}
                            {{for $i = count($scfegfptas); $i < $data->maxCountFE; $i++}}
                            <td></td>
                            {{/for}}
                        </tr>
                    {{/foreach}}
                {{/foreach}}
                </tbody>
            </table>
        </div>
    </div>

</div>
    </div>
            <div id="reportLUSouthPane" region="south" title="Sentences" style="height: 40%">
                <div class="text">
                    <a href="#" class="easyui-linkbutton" onclick="javascript:clearSentences()">Clear Sentences</a>
                    <a href="#" class="easyui-linkbutton" onclick="javascript:toogleSentenceColors()">Toogle Colors</a>
                </div>
                <div id="divLexicalEntrySentences" class="text">
                </div>
            </div>

</div>

<script type="text/javascript">
    $.parser.parse();

    $('#reportLULayout').layout({
        fit: true
    });

    var realizationAS = {{MUtil::php2js($data->realizationAS)|noescape}};
    var feAS = {{$data->feAS|noescape}};
    var patternFEAS = {{$data->patternFEAS|noescape}};
    var patternAS = {{$data->patternAS|noescape}};

    function clearSentences() {
        $("#divLexicalEntrySentences").html('');
    }

    function toogleSentenceColors() {
        console.log('toogle sentence coloros');
    }

    function addFESentences(feEntry) {
        console.log(feAS[feEntry]);
        manager.doAjax({{$manager->getURL('api/reportlu/getSentences')}}, function (data) {
            console.log(data);
            $.each(data, function(index, sentence ) {
                var id = "sentence" + sentence.idSentence;
                if ($('#' + id).length) {
                    //$(sentence.text).replaceAll('#' + id);
                } else {
                    $("#divLexicalEntrySentences").append( "<div class='sentence' id='" + id + "'>" + sentence.text + "</div>" );
                }
            });

        }, {idAS: feAS[feEntry]});
    }

    function addASSentences(asSet) {
        manager.doAjax({{$manager->getURL('api/reportlu/getSentences')}}, function (data) {
            console.log(data);
            $.each(data, function(index, sentence ) {
                var id = "sentence" + sentence.idSentence;
                if ($('#' + id).length) {
                    //$(sentence.text).replaceAll('#' + id);
                } else {
                    $("#divLexicalEntrySentences").append( "<div class='sentence' id='" + id + "'>" + sentence.text + "</div>" );
                }
            });

        }, {idAS: asSet});
    }

    function addSentences(id) {

    }

</script>
<style type="text/css">

    #divLexicalEntrySentences {
        padding: 5px;
    }

    #divLexicalEntrySentences .sentence {
        padding: 3px;
    }

    .fe_target {
        color: rgb(255, 255, 255); background-color: rgb(0, 0, 0); text-transform:uppercase;
    }
    {{foreach $data->fe['styles'] as $style}}
    .fe_{{$style['entry']|noescape}} {color: #{{$style['rgbFg']}}; background-color: #{{$style['rgbBg']}};}
    {{/foreach}}

</style>